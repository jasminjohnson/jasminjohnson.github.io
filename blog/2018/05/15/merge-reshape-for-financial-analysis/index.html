<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Jasmin Johnson">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Data Analysis With Python for Excel Users III - Merge and Reshape Data | Financial Analysis Journal</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Financial Analysis Journal blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
//  max-width: 100%;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
        <script type="text/javascript">
        init_mathjax = function() {
            if (window.MathJax) {
                // MathJax loaded
                MathJax.Hub.Config({
                    tex2jax: {
                        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                    },
                    displayAlign: 'left', // Change this to 'center' to center equations.
                    "HTML-CSS": {
                        styles: {'.MathJax_Display': {"margin": 0}}
                    }
                });
                MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
            }
        }
        init_mathjax();
        </script>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Financial Analysis Journal</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                            <li><a class="nodec icon-rss" href="/feeds/all.atom.xml" title="jasminjohnson.github.io RSS feed" rel="me"></a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Data Analysis With Python for Excel Users III - Merge and Reshape Data</h1>
            <time datetime="article.date.isoformat()" pubdate>Tue 15 May 2018</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">


<p>As a CPA, I have had to work with datasets from data processing applications, such as insurance application, general ledger,
regulatory reporting system and etc.</p>
<p>The process is to incorporate all the data then create reinsurance analysis for pricing treaties, pro-forma financial analysis
for new business opportunity, regulatory compliance and risk assessment for stress test.</p>
<p>As an old saying that the data needs to be valid, otherwise will be "Garbage In and Garbage Out".</p>
<p>The first step for data preparation process involves loading, validating, merging and reshaping of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-to-get-a-clean-and-valid-dataset?">How to get a clean and valid dataset?<a class="anchor-link" href="#How-to-get-a-clean-and-valid-dataset?">&#182;</a></h3><ul>
<li>Join two or more dataframes by using a key or composite key</li>
<li>Spot invalid data by using pandas <ul>
<li>Pandas offers functionality similar to Excel Vlookup, Sumif etc.</li>
<li>I expect every fellow accountant reading this blog might be asking "Why don't I just continue using Excel?"</li>
<li>It took me a while to understand that python-pandas offer much more effectively way to deal with huge dataset</li>
</ul>
</li>
<li>Remove duplicate data</li>
<li>Calculate the average value or the maximum value of certain dataset</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example---Reinsurance-Premium-Loss-Data">Example - Reinsurance Premium Loss Data<a class="anchor-link" href="#Example---Reinsurance-Premium-Loss-Data">&#182;</a></h3><p>The example is to merge and reshape data from different applications and ultimately determing business reinsurance coverage.
This is a simplified and hypothetical example, but it's a great illustration of what Python can do for financial analysis.</p>
<ul>
<li>The example data is generated by randomization algorithms</li>
<li>The input data is an excel file consisting of 2 tabs: premium and loss    </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understand-the-business,-what-is-abnormal-value-for-this-business?">Understand the business, what is abnormal value for this business?<a class="anchor-link" href="#Understand-the-business,-what-is-abnormal-value-for-this-business?">&#182;</a></h3><ul>
<li>If average premium per policy is between 10K to 200K, the premium outside this range is invalid</li>
<li>If maximum ceded reinsurance retention is 500K, the ceded recoverable greater than 500K is invalid </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="View-Excel-File-with-Mulitple-Tabs">View Excel File with Mulitple Tabs<a class="anchor-link" href="#View-Excel-File-with-Mulitple-Tabs">&#182;</a></h3><ul>
<li>List of tabs</li>
<li>View each tabs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;data/Premium_Loss.xlsx&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;df_list.sheet_names=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">df_list</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>df_list.sheet_names=[&#39;premium&#39;, &#39;loss&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_premium</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/Premium_Loss.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s2">&quot;premium&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> policies - here are the first 5:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">df_premium</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
<span class="n">df_premium</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> 
<span class="n">df_prem_dupes</span><span class="o">=</span><span class="n">df_premium</span><span class="p">[</span><span class="n">df_premium</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> duplicate policies&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">df_dupes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
<span class="n">df_prem_dupes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 200 policies - here are the first 5:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type</th>
      <th>Premium</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10880</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-07-08</td>
      <td>Phy</td>
      <td>CM</td>
      <td>232058</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>96289.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91809.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91809.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91367.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91367.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 2 duplicate policies
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type</th>
      <th>Premium</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91809.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>91367.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>*** duplicate rows were found in the file, more detail about removing duplicate rows at the end of the blog</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/Premium_Loss.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s2">&quot;loss&quot;</span><span class="p">)</span> 
<span class="n">df_loss</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">Count_Row</span><span class="o">=</span><span class="n">df_loss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> claims with losses&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Count_Row</span><span class="p">))</span>  
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>Claim Number</th>
      <th>Policy Type</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>LossDate</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>35033</td>
      <td>880247</td>
      <td>OCC</td>
      <td>Adolph</td>
      <td>Iwan</td>
      <td>2017-03-17</td>
      <td>84373.0</td>
      <td>10000000</td>
      <td>176966.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>35033</td>
      <td>880247</td>
      <td>OCC</td>
      <td>Adolph</td>
      <td>Iwan</td>
      <td>2017-03-17</td>
      <td>84373.0</td>
      <td>5000000</td>
      <td>176966.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>47755</td>
      <td>880255</td>
      <td>OCC</td>
      <td>Cherryl</td>
      <td>Aven</td>
      <td>2017-11-25</td>
      <td>88205.0</td>
      <td>4000000</td>
      <td>116133.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47755</td>
      <td>880255</td>
      <td>OCC</td>
      <td>Cherryl</td>
      <td>Aven</td>
      <td>2017-11-25</td>
      <td>88205.0</td>
      <td>54785</td>
      <td>116133.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36838</td>
      <td>880258</td>
      <td>OCC</td>
      <td>Franklin</td>
      <td>Maen</td>
      <td>2017-03-18</td>
      <td>36440.0</td>
      <td>54880</td>
      <td>65872.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 216 claims with losses
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-many-policies-have-incurred-losses?-and-save-the-result-to-Excel">How many policies have incurred losses? and save the result to Excel<a class="anchor-link" href="#How-many-policies-have-incurred-losses?-and-save-the-result-to-Excel">&#182;</a></h3><ul>
<li>Use Merge function with key identifier Policy Number</li>
<li>Pandas.merge connects rows in DataFrames based on one or more keys</li>
<li>By default merge does an 'inner' join - the keys in the result are the intersection with prepend X and Y</li>
<li>Save the merge file to Excel</li>
<li>How many policies have incurred losses? use shape function</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_premium</span> <span class="o">=</span> <span class="n">df_list</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;premium&quot;</span><span class="p">)</span>
<span class="n">df_loss</span> <span class="o">=</span> <span class="n">df_list</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_premium</span><span class="p">,</span> <span class="n">df_loss</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Policy Number&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> policies with incurred losses - here are the first 5:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">df_merge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
<span class="n">df_merge</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;data/incurredloss.xlsx&#39;</span><span class="p">)</span> 
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 24 policies with incurred losses - here are the first 5:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[30]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name_x</th>
      <th>Last Name_x</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type_x</th>
      <th>Premium_x</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
      <th>Claim Number</th>
      <th>Policy Type_y</th>
      <th>First Name_y</th>
      <th>Last Name_y</th>
      <th>LossDate</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10880</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-07-08</td>
      <td>Phy</td>
      <td>CM</td>
      <td>232058</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>96289.0</td>
      <td>880206</td>
      <td>CM</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-09-24</td>
      <td>74793.0</td>
      <td>250000</td>
      <td>232058.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10948</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2017-06-05</td>
      <td>Podiatrist</td>
      <td>CM</td>
      <td>5132</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>99671.0</td>
      <td>880208</td>
      <td>CM</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2018-04-22</td>
      <td>38573.0</td>
      <td>800000</td>
      <td>5132.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10244</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-08-07</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>13330</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>92319.0</td>
      <td>880016</td>
      <td>OCC</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-09-14</td>
      <td>44072.0</td>
      <td>1500000</td>
      <td>13330.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10509</td>
      <td>Patrica</td>
      <td>Hartle</td>
      <td>2017-02-09</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>5647</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>96730.0</td>
      <td>880041</td>
      <td>OCC</td>
      <td>Patrica</td>
      <td>Hartle</td>
      <td>2017-11-16</td>
      <td>88069.0</td>
      <td>1000000</td>
      <td>5647.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10700</td>
      <td>Sabra</td>
      <td>Higgenbotham</td>
      <td>2017-10-07</td>
      <td>PA</td>
      <td>OCC</td>
      <td>12021</td>
      <td>1000000</td>
      <td>3900000</td>
      <td>90239.0</td>
      <td>880205</td>
      <td>OCC</td>
      <td>Sabra</td>
      <td>Higgenbotham</td>
      <td>2017-12-05</td>
      <td>97247.0</td>
      <td>2500000</td>
      <td>12021.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Which-policy-has-no-incurred-losses?-use-Outer-join-to-merge-the-data">Which policy has no incurred losses? use Outer join to merge the data<a class="anchor-link" href="#Which-policy-has-no-incurred-losses?-use-Outer-join-to-merge-the-data">&#182;</a></h3><ul>
<li>Other possible options are 'left', 'right', and 'outer'. </li>
<li>The outer join takes the union of the keys, combining the effect of applying both left and right joins</li>
<li>Policy 10962 has no associated loss data, the missing loss result marks as NaN</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_premium</span> <span class="o">=</span> <span class="n">df_list</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;premium&quot;</span><span class="p">)</span>
<span class="n">df_loss</span> <span class="o">=</span> <span class="n">df_list</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_premium</span><span class="p">,</span> <span class="n">df_loss</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Policy Number&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[31]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name_x</th>
      <th>Last Name_x</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type_x</th>
      <th>Premium_x</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
      <th>Claim Number</th>
      <th>Policy Type_y</th>
      <th>First Name_y</th>
      <th>Last Name_y</th>
      <th>LossDate</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10880</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-07-08</td>
      <td>Phy</td>
      <td>CM</td>
      <td>232058.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>96289.0</td>
      <td>880206.0</td>
      <td>CM</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-09-24</td>
      <td>74793.0</td>
      <td>250000.0</td>
      <td>232058.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91809.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91809.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10948</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2017-06-05</td>
      <td>Podiatrist</td>
      <td>CM</td>
      <td>5132.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>99671.0</td>
      <td>880208.0</td>
      <td>CM</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2018-04-22</td>
      <td>38573.0</td>
      <td>800000.0</td>
      <td>5132.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10244</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-08-07</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>13330.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>92319.0</td>
      <td>880016.0</td>
      <td>OCC</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-09-14</td>
      <td>44072.0</td>
      <td>1500000.0</td>
      <td>13330.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>11106</td>
      <td>NaN</td>
      <td>Sarasota Hospital</td>
      <td>2017-08-14</td>
      <td>Hospital</td>
      <td>OCC</td>
      <td>446997.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>97303.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>11271</td>
      <td>Zola</td>
      <td>Fitzwallace</td>
      <td>2017-07-15</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>24252.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>97474.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10509</td>
      <td>Patrica</td>
      <td>Hartle</td>
      <td>2017-02-09</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>5647.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>96730.0</td>
      <td>880041.0</td>
      <td>OCC</td>
      <td>Patrica</td>
      <td>Hartle</td>
      <td>2017-11-16</td>
      <td>88069.0</td>
      <td>1000000.0</td>
      <td>5647.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data-Transformation---Removing-Duplicates">Data Transformation - Removing Duplicates<a class="anchor-link" href="#Data-Transformation---Removing-Duplicates">&#182;</a></h3><ul>
<li>The DataFrame method Duplicated returns a boolean series</li>
<li>True means duplicated data</li>
<li>drop_duplicates returns a DataFrame where the duplicated array is True<ul>
<li>Our example showing duplicated policy 10962, the output showed as "True"</li>
</ul>
</li>
<li>Both of these methods by default consider all of the columns must be duplicated</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dupes</span><span class="o">=</span><span class="n">df_merge</span><span class="p">[</span><span class="n">df_merge</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> duplicate policies - here are the first 10, if more than 10:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">df_dupes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
<span class="n">df_dupes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 2 duplicate policies - here are the first 10:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[34]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name_x</th>
      <th>Last Name_x</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type_x</th>
      <th>Premium_x</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
      <th>Claim Number</th>
      <th>Policy Type_y</th>
      <th>First Name_y</th>
      <th>Last Name_y</th>
      <th>LossDate</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91809.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_merge_clean</span><span class="o">=</span><span class="n">df_merge</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df_merge_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[37]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Policy Number</th>
      <th>First Name_x</th>
      <th>Last Name_x</th>
      <th>Policy Effective Date</th>
      <th>LOB</th>
      <th>Policy Type_x</th>
      <th>Premium_x</th>
      <th>Coverage</th>
      <th>Excess Coverage</th>
      <th>Excess Policy</th>
      <th>Claim Number</th>
      <th>Policy Type_y</th>
      <th>First Name_y</th>
      <th>Last Name_y</th>
      <th>LossDate</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10880</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-07-08</td>
      <td>Phy</td>
      <td>CM</td>
      <td>232058.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>96289.0</td>
      <td>880206.0</td>
      <td>CM</td>
      <td>Kurtis</td>
      <td>Dumm</td>
      <td>2017-09-24</td>
      <td>74793.0</td>
      <td>250000.0</td>
      <td>232058.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10962</td>
      <td>Taisha</td>
      <td>Whack</td>
      <td>2017-09-19</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>11308.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91809.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11339</td>
      <td>Ricarda</td>
      <td>Hotaka</td>
      <td>2017-12-25</td>
      <td>Podiatrist</td>
      <td>OCC</td>
      <td>2651.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>91367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10948</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2017-06-05</td>
      <td>Podiatrist</td>
      <td>CM</td>
      <td>5132.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>99671.0</td>
      <td>880208.0</td>
      <td>CM</td>
      <td>Florencia</td>
      <td>Bilyk</td>
      <td>2018-04-22</td>
      <td>38573.0</td>
      <td>800000.0</td>
      <td>5132.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10244</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-08-07</td>
      <td>Dentist</td>
      <td>OCC</td>
      <td>13330.0</td>
      <td>1000000.0</td>
      <td>3900000.0</td>
      <td>92319.0</td>
      <td>880016.0</td>
      <td>OCC</td>
      <td>Wonda</td>
      <td>Hallsworth</td>
      <td>2017-09-14</td>
      <td>44072.0</td>
      <td>1500000.0</td>
      <td>13330.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Analyze-loss-data-for-placing-reinsurance-treaty">Analyze loss data for placing reinsurance treaty<a class="anchor-link" href="#Analyze-loss-data-for-placing-reinsurance-treaty">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Detecting-and-Filtering-Outliers---how-to-detecting-abnormal-loss-value?">Detecting and Filtering Outliers - how to detecting abnormal loss value?<a class="anchor-link" href="#Detecting-and-Filtering-Outliers---how-to-detecting-abnormal-loss-value?">&#182;</a></h3><ul>
<li>Filtering or transforming outliers by applying array operations</li>
<li>Loss should not exceeded 1 million since the policy limit is 1M</li>
<li>Use the abs method in column Loss when loss is exceeding 1M </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_loss_greater_than_1M</span> <span class="o">=</span> <span class="n">df_loss</span><span class="p">[</span><span class="n">df_loss</span><span class="p">[</span><span class="s1">&#39;Loss&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%s</span><span class="s2"> claims with losses &gt; 1M - here they are:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">df_loss_greater_than_1M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
<span class="n">df_loss_greater_than_1M</span><span class="p">[[</span><span class="s1">&#39;Claim Number&#39;</span><span class="p">,</span><span class="s1">&#39;Loss&#39;</span><span class="p">]]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 8 claims with losses &gt; 1M - here they are:
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[48]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim Number</th>
      <th>Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>880247</td>
      <td>10000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>880247</td>
      <td>5000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>880255</td>
      <td>4000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>880016</td>
      <td>1500000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>880205</td>
      <td>2500000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>880489</td>
      <td>10000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>880754</td>
      <td>7000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>880979</td>
      <td>3000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Discretization-and-Binning---how-to-seperate-loss-into-reinsurance-layer?">Discretization and Binning - how to seperate loss into reinsurance layer?<a class="anchor-link" href="#Discretization-and-Binning---how-to-seperate-loss-into-reinsurance-layer?">&#182;</a></h3><ul>
<li>Separated loss into “bins” for reinsurance analysis</li>
<li>We can group the loss range and analyze the loss layer for placing reinsurance treaty</li>
<li>Group claim data into discrete loss buckets</li>
<li>Let’s divide these into bins of 1 to 50000, 50001 to 75000, 75001 to 1000000, and finally 1000001 and greater</li>
<li>To do so, use cut function in pandas</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 1st output - Sepaprated loss into bins and print out first five rows</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">75000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">,</span> <span class="mi">20000000</span> <span class="p">]</span>
<span class="n">cats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_loss</span><span class="p">[</span><span class="s1">&#39;Loss&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">cats</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 2nd output - Count how many loss in the speific bins - ie there are 150 claims in the loss range 75K to 500K</span>
<span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">cats</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[56]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    (1000000, 20000000]
1    (1000000, 20000000]
2    (1000000, 20000000]
3         (50000, 75000]
4         (50000, 75000]
Name: Loss, dtype: category
Categories (5, interval[int64]): [(1, 50000] &lt; (50000, 75000] &lt; (75000, 500000] &lt; (500000, 1000000] &lt; (1000000, 20000000]]</pre>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[56]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(75000, 500000]        150
(50000, 75000]          35
(1, 50000]              18
(1000000, 20000000]      8
(500000, 1000000]        5
Name: Loss, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 1st output - Show first 3 claims according to the matching loss categories</span>
<span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_loss</span><span class="p">[</span><span class="s1">&#39;Loss&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">75000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">,</span> <span class="mi">20000000</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># 2nd ouput - Group claim data into discrete loss bins by assigning group names, ie. showing first loss is a Clash coverage etc.</span>
<span class="n">group_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Layer1&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer2&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer3&#39;</span><span class="p">,</span> <span class="s1">&#39;XOL&#39;</span><span class="p">,</span><span class="s1">&#39;Clash&#39;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_loss</span><span class="p">[</span><span class="s1">&#39;Loss&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">group_names</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[58]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    [1000000, 20000000)
1    [1000000, 20000000)
2    [1000000, 20000000)
Name: Loss, dtype: category
Categories (5, interval[int64]): [[1, 50000) &lt; [50000, 75000) &lt; [75000, 500000) &lt; [500000, 1000000) &lt; [1000000, 20000000)]</pre>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[58]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     Clash
1     Clash
2     Clash
3    Layer2
4    Layer2
Name: Loss, dtype: category
Categories (5, object): [Layer1 &lt; Layer2 &lt; Layer3 &lt; XOL &lt; Clash]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plotting-and-Visualization---Dashboard-to-show-loss-distribution-by-line-of-business">Plotting and Visualization - Dashboard to show loss distribution by line of business<a class="anchor-link" href="#Plotting-and-Visualization---Dashboard-to-show-loss-distribution-by-line-of-business">&#182;</a></h3><ul>
<li>Pandas has an increasing number of high-level plotting methods for creating standard visualizations that take advantage of how data is organized in DataFrame objects</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Use panda.DataFrame to plot </span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Group claims by Line of Business LOB and set Loss_Date as index</span>
<span class="n">df_claims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/Claim.xlsx&#39;</span><span class="p">)</span>
<span class="n">df_claims</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

<span class="n">df_claims</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Loss_Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_claims_by_lob</span> <span class="o">=</span> <span class="n">df_claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;LOB&#39;</span><span class="p">)</span>
<span class="n">df_claims_by_lob</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[76]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim_Number</th>
      <th>Loss_Date</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
      <th>LOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>883745</td>
      <td>2016-09-24</td>
      <td>95846.0</td>
      <td>147030</td>
      <td>165910.0</td>
      <td>Podiatrist</td>
    </tr>
    <tr>
      <th>1</th>
      <td>884654</td>
      <td>2016-05-14</td>
      <td>95514.0</td>
      <td>121666</td>
      <td>72314.0</td>
      <td>Podiatrist</td>
    </tr>
    <tr>
      <th>2</th>
      <td>880247</td>
      <td>2017-03-17</td>
      <td>84373.0</td>
      <td>10000000</td>
      <td>176966.0</td>
      <td>Physician</td>
    </tr>
    <tr>
      <th>3</th>
      <td>880247</td>
      <td>2017-03-17</td>
      <td>84373.0</td>
      <td>5000000</td>
      <td>176966.0</td>
      <td>Physician</td>
    </tr>
    <tr>
      <th>4</th>
      <td>884476</td>
      <td>2016-10-23</td>
      <td>66484.0</td>
      <td>141288</td>
      <td>74632.0</td>
      <td>Podiatrist</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[76]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.core.groupby.DataFrameGroupBy object at 0x000001B1EA643B00&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># View claim by LOB - Nurse </span>
<span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Nurse&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[77]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim_Number</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
      <th>LOB</th>
    </tr>
    <tr>
      <th>Loss_Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-03-28</th>
      <td>889851</td>
      <td>25422.0</td>
      <td>161796</td>
      <td>208103.0</td>
      <td>Nurse</td>
    </tr>
    <tr>
      <th>2016-01-01</th>
      <td>889591</td>
      <td>75493.0</td>
      <td>279318</td>
      <td>81236.0</td>
      <td>Nurse</td>
    </tr>
    <tr>
      <th>2016-08-09</th>
      <td>889877</td>
      <td>80758.0</td>
      <td>54114</td>
      <td>60416.0</td>
      <td>Nurse</td>
    </tr>
    <tr>
      <th>2016-12-26</th>
      <td>889550</td>
      <td>81824.0</td>
      <td>52413</td>
      <td>127804.0</td>
      <td>Nurse</td>
    </tr>
    <tr>
      <th>2016-05-26</th>
      <td>889443</td>
      <td>38710.0</td>
      <td>138060</td>
      <td>211168.0</td>
      <td>Nurse</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Identify-Maxium,-Mininum-and-Average-Loss-Adjusted-Expenses-(LAE)-by-LOB">Identify Maxium, Mininum and Average Loss Adjusted Expenses (LAE) by LOB<a class="anchor-link" href="#Identify-Maxium,-Mininum-and-Average-Loss-Adjusted-Expenses-(LAE)-by-LOB">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Sorting is default by sorint the first sortable column which is LAE in this example</span>
<span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[78]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim_Number</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
    </tr>
    <tr>
      <th>LOB</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dentist</th>
      <td>889215</td>
      <td>98396.0</td>
      <td>290832</td>
      <td>240383.0</td>
    </tr>
    <tr>
      <th>Hospital</th>
      <td>886684</td>
      <td>99984.0</td>
      <td>298038</td>
      <td>245159.0</td>
    </tr>
    <tr>
      <th>Nurse</th>
      <td>889877</td>
      <td>98914.0</td>
      <td>279318</td>
      <td>246635.0</td>
    </tr>
    <tr>
      <th>Physician</th>
      <td>881144</td>
      <td>266019.0</td>
      <td>10000000</td>
      <td>248063.0</td>
    </tr>
    <tr>
      <th>Podiatrist</th>
      <td>884888</td>
      <td>98013.0</td>
      <td>294633</td>
      <td>248669.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[78]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim_Number</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
    </tr>
    <tr>
      <th>LOB</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dentist</th>
      <td>886716</td>
      <td>26077.0</td>
      <td>28162</td>
      <td>11067.0</td>
    </tr>
    <tr>
      <th>Hospital</th>
      <td>881331</td>
      <td>26687.0</td>
      <td>27063</td>
      <td>11604.0</td>
    </tr>
    <tr>
      <th>Nurse</th>
      <td>889258</td>
      <td>25422.0</td>
      <td>34679</td>
      <td>16548.0</td>
    </tr>
    <tr>
      <th>Physician</th>
      <td>880016</td>
      <td>36440.0</td>
      <td>25404</td>
      <td>3555.0</td>
    </tr>
    <tr>
      <th>Podiatrist</th>
      <td>883421</td>
      <td>25720.0</td>
      <td>26062</td>
      <td>32051.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="prompt output_prompt">Out[78]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Claim_Number</th>
      <th>LAE</th>
      <th>Loss</th>
      <th>Premium</th>
    </tr>
    <tr>
      <th>LOB</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dentist</th>
      <td>887691.615385</td>
      <td>58849.846154</td>
      <td>1.204308e+05</td>
      <td>132381.153846</td>
    </tr>
    <tr>
      <th>Hospital</th>
      <td>884071.576923</td>
      <td>67452.857143</td>
      <td>1.341324e+05</td>
      <td>128511.779221</td>
    </tr>
    <tr>
      <th>Nurse</th>
      <td>889543.666667</td>
      <td>67108.809524</td>
      <td>1.198330e+05</td>
      <td>156925.095238</td>
    </tr>
    <tr>
      <th>Physician</th>
      <td>880730.512821</td>
      <td>91185.393939</td>
      <td>1.289591e+06</td>
      <td>92691.666667</td>
    </tr>
    <tr>
      <th>Podiatrist</th>
      <td>884066.743590</td>
      <td>63871.210526</td>
      <td>1.370890e+05</td>
      <td>147778.447368</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sumarize-Statistics-Value-by-Describe-function">Sumarize Statistics Value by Describe function<a class="anchor-link" href="#Sumarize-Statistics-Value-by-Describe-function">&#182;</a></h3><ul>
<li>Describe generates descriptive statistics that summarize the central tendency, dispersion and shape of a dataset’s distribution, excluding NaN values</li>
<li>Transpose the results</li>
<li>Save the result to Excel called claim_distribution.xlsx</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[84]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LOB</th>
      <th>Dentist</th>
      <th>Hospital</th>
      <th>Nurse</th>
      <th>Physician</th>
      <th>Podiatrist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">Claim_Number</th>
      <th>count</th>
      <td>39.000000</td>
      <td>78.000000</td>
      <td>21.000000</td>
      <td>3.900000e+01</td>
      <td>39.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>887691.615385</td>
      <td>884071.576923</td>
      <td>889543.666667</td>
      <td>8.807305e+05</td>
      <td>884066.743590</td>
    </tr>
    <tr>
      <th>std</th>
      <td>696.825494</td>
      <td>1885.292368</td>
      <td>164.153993</td>
      <td>3.919108e+02</td>
      <td>426.330531</td>
    </tr>
    <tr>
      <th>min</th>
      <td>886716.000000</td>
      <td>881331.000000</td>
      <td>889258.000000</td>
      <td>8.800160e+05</td>
      <td>883421.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>887096.500000</td>
      <td>882258.750000</td>
      <td>889453.000000</td>
      <td>8.803075e+05</td>
      <td>883704.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>887629.000000</td>
      <td>884159.000000</td>
      <td>889536.000000</td>
      <td>8.808280e+05</td>
      <td>884098.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>888210.500000</td>
      <td>885918.250000</td>
      <td>889627.000000</td>
      <td>8.811165e+05</td>
      <td>884333.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>889215.000000</td>
      <td>886684.000000</td>
      <td>889877.000000</td>
      <td>8.811440e+05</td>
      <td>884888.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">LAE</th>
      <th>count</th>
      <td>39.000000</td>
      <td>77.000000</td>
      <td>21.000000</td>
      <td>3.300000e+01</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>58849.846154</td>
      <td>67452.857143</td>
      <td>67108.809524</td>
      <td>9.118539e+04</td>
      <td>63871.210526</td>
    </tr>
    <tr>
      <th>std</th>
      <td>22419.689897</td>
      <td>20667.968208</td>
      <td>24679.796034</td>
      <td>6.140598e+04</td>
      <td>24470.395554</td>
    </tr>
    <tr>
      <th>min</th>
      <td>26077.000000</td>
      <td>26687.000000</td>
      <td>25422.000000</td>
      <td>3.644000e+04</td>
      <td>25720.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>39682.500000</td>
      <td>52542.000000</td>
      <td>38710.000000</td>
      <td>4.407200e+04</td>
      <td>40691.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>55733.000000</td>
      <td>65949.000000</td>
      <td>74536.000000</td>
      <td>8.380300e+04</td>
      <td>64691.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>82280.000000</td>
      <td>83906.000000</td>
      <td>87607.000000</td>
      <td>8.820500e+04</td>
      <td>84944.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>98396.000000</td>
      <td>99984.000000</td>
      <td>98914.000000</td>
      <td>2.660190e+05</td>
      <td>98013.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Loss</th>
      <th>count</th>
      <td>39.000000</td>
      <td>78.000000</td>
      <td>21.000000</td>
      <td>3.900000e+01</td>
      <td>39.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>120430.846154</td>
      <td>134132.435897</td>
      <td>119832.952381</td>
      <td>1.289591e+06</td>
      <td>137089.025641</td>
    </tr>
    <tr>
      <th>std</th>
      <td>65823.016078</td>
      <td>74520.857552</td>
      <td>66931.409306</td>
      <td>2.548037e+06</td>
      <td>68111.792047</td>
    </tr>
    <tr>
      <th>min</th>
      <td>28162.000000</td>
      <td>27063.000000</td>
      <td>34679.000000</td>
      <td>2.540400e+04</td>
      <td>26062.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>76317.000000</td>
      <td>75668.500000</td>
      <td>56682.000000</td>
      <td>7.030800e+04</td>
      <td>87240.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>101685.000000</td>
      <td>115942.000000</td>
      <td>102922.000000</td>
      <td>1.665280e+05</td>
      <td>125148.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>150865.000000</td>
      <td>185442.750000</td>
      <td>161796.000000</td>
      <td>8.250000e+05</td>
      <td>181604.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>290832.000000</td>
      <td>298038.000000</td>
      <td>279318.000000</td>
      <td>1.000000e+07</td>
      <td>294633.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Premium</th>
      <th>count</th>
      <td>39.000000</td>
      <td>77.000000</td>
      <td>21.000000</td>
      <td>3.300000e+01</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>132381.153846</td>
      <td>128511.779221</td>
      <td>156925.095238</td>
      <td>9.269167e+04</td>
      <td>147778.447368</td>
    </tr>
    <tr>
      <th>std</th>
      <td>68173.058611</td>
      <td>71271.028006</td>
      <td>65437.784797</td>
      <td>7.203135e+04</td>
      <td>61953.865303</td>
    </tr>
    <tr>
      <th>min</th>
      <td>11067.000000</td>
      <td>11604.000000</td>
      <td>16548.000000</td>
      <td>3.555000e+03</td>
      <td>32051.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>82629.000000</td>
      <td>68693.000000</td>
      <td>110571.000000</td>
      <td>4.740600e+04</td>
      <td>87153.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>129721.000000</td>
      <td>127505.000000</td>
      <td>179483.000000</td>
      <td>6.901200e+04</td>
      <td>158876.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>191241.000000</td>
      <td>189094.000000</td>
      <td>211991.000000</td>
      <td>1.573400e+05</td>
      <td>188406.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>240383.000000</td>
      <td>245159.000000</td>
      <td>246635.000000</td>
      <td>2.480630e+05</td>
      <td>248669.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_claims_by_lob</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;data/claim_distribution.xlsx&#39;</span><span class="p">)</span>
<span class="n">df_claim_dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/claim_distribution.xlsx&#39;</span><span class="p">)</span>
<span class="n">df_claim_dist</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[80]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Dentist</th>
      <th>Hospital</th>
      <th>Nurse</th>
      <th>Physician</th>
      <th>Podiatrist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Claim_Number</th>
      <th>count</th>
      <td>39.000000</td>
      <td>78.000000</td>
      <td>21.000000</td>
      <td>39.000000</td>
      <td>39.000000</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">NaN</th>
      <th>mean</th>
      <td>887691.615385</td>
      <td>884071.576923</td>
      <td>889543.666667</td>
      <td>880730.512821</td>
      <td>884066.743590</td>
    </tr>
    <tr>
      <th>std</th>
      <td>696.825494</td>
      <td>1885.292368</td>
      <td>164.153993</td>
      <td>391.910763</td>
      <td>426.330531</td>
    </tr>
    <tr>
      <th>min</th>
      <td>886716.000000</td>
      <td>881331.000000</td>
      <td>889258.000000</td>
      <td>880016.000000</td>
      <td>883421.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>887096.500000</td>
      <td>882258.750000</td>
      <td>889453.000000</td>
      <td>880307.500000</td>
      <td>883704.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>887629.000000</td>
      <td>884159.000000</td>
      <td>889536.000000</td>
      <td>880828.000000</td>
      <td>884098.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>888210.500000</td>
      <td>885918.250000</td>
      <td>889627.000000</td>
      <td>881116.500000</td>
      <td>884333.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>889215.000000</td>
      <td>886684.000000</td>
      <td>889877.000000</td>
      <td>881144.000000</td>
      <td>884888.000000</td>
    </tr>
    <tr>
      <th>LAE</th>
      <th>count</th>
      <td>39.000000</td>
      <td>77.000000</td>
      <td>21.000000</td>
      <td>33.000000</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>NaN</th>
      <th>mean</th>
      <td>58849.846154</td>
      <td>67452.857143</td>
      <td>67108.809524</td>
      <td>91185.393939</td>
      <td>63871.210526</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loss-distribution-by-LOB---use-groupby-plot">Loss distribution by LOB - use groupby plot<a class="anchor-link" href="#Loss-distribution-by-LOB---use-groupby-plot">&#182;</a></h3><ul>
<li>After saving the loss distribution to a dataframe, we can Use groupby function to plot the result</li>
<li>This can be very helpful, that means we can reuse this code when reload the data from IS or other application on the weekly, monthly, or quarterly basis</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_claims_by_lob</span><span class="p">[</span><span class="s1">&#39;Loss&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LOB
Dentist       AxesSubplot(0.125,0.2;0.775x0.68)
Hospital      AxesSubplot(0.125,0.2;0.775x0.68)
Nurse         AxesSubplot(0.125,0.2;0.775x0.68)
Physician     AxesSubplot(0.125,0.2;0.775x0.68)
Podiatrist    AxesSubplot(0.125,0.2;0.775x0.68)
Name: Loss, dtype: object</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>

        <div class="meta">
            <div>
                    <a href="http://jasminjohnson.github.io/tag/financial.html" class="tag">financial</a>
                    <a href="http://jasminjohnson.github.io/tag/pandas.html" class="tag">pandas</a>
                    <a href="http://jasminjohnson.github.io/tag/merge.html" class="tag">merge</a>
            </div>
        </div>
    </article>


</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
<!--
    <footer>
      <p>
        © 2012-2017 Jasmin Johnson, license <a href="https://github.com/jasminjohnson/jasminjohnson.github.io-source/blob/master/LICENSE"> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    </body>
</html>